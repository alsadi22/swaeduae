<?php
namespace App\Console\Commands;
use Illuminate\Console\Command; use App\Services\AgentScanner;
class AgentPatch extends Command {
  protected $signature='agent:patch {--apply} {--revert}';
  protected $description='Apply or revert the latest staged patches';
  public function handle(AgentScanner $scanner){
    if($this->option('apply')){ $r=$scanner->applyLatest(); $this->info('Applied: '.($r['applied']??0).' files from '.($r['dir']??'')); }
    elseif($this->option('revert')){ $r=$scanner->revertLatest(); $this->info('Reverted: '.($r['reverted']??0).' files from '.($r['dir']??'')); }
    else { $this->warn('Choose --apply or --revert'); }
    return self::SUCCESS;
  }
}
